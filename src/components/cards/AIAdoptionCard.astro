---
/**
 * AI Adoption Card
 *
 * Visual showing the percentage of AI templates in the ecosystem.
 * Key unique insight - shows how AI automation has taken over n8n.
 */

import { formatNumber } from '@/lib/utils/formatters';

interface Props {
  aiTemplates: number;
  totalTemplates: number;
  aiAgentTemplates?: number;  // Templates using AI Agent node specifically
}

const { aiTemplates, totalTemplates, aiAgentTemplates } = Astro.props;

const aiPercentage = Math.round((aiTemplates / totalTemplates) * 100);
const aiAgentPercentage = aiAgentTemplates ? Math.round((aiAgentTemplates / totalTemplates) * 100) : null;
---

<div class="card">
  <div class="flex items-center justify-between mb-3">
    <div>
      <h3 class="text-lg font-semibold text-white">AI Dominance</h3>
      <p class="text-sm text-gray-500">AI adoption in templates</p>
    </div>
    <a href="/templates" class="text-n8n-primary text-sm hover:underline">Details &rarr;</a>
  </div>

  <!-- AI Templates bar -->
  <div class="mb-4">
    <div class="flex items-center justify-between mb-1">
      <span class="text-sm text-gray-300">AI Category Templates</span>
      <span class="text-lg font-bold text-purple-400">{aiPercentage}%</span>
    </div>
    <div class="relative h-6 bg-gray-800 rounded overflow-hidden">
      <div
        class="absolute inset-y-0 left-0 bg-gradient-to-r from-purple-600 to-purple-400 transition-all duration-500"
        style={`width: ${aiPercentage}%;`}
      />
    </div>
    <div class="text-xs text-gray-500 mt-1">
      {formatNumber(aiTemplates)} of {formatNumber(totalTemplates)} templates
    </div>
  </div>

  <!-- AI Agent bar -->
  {aiAgentPercentage !== null && (
    <div>
      <div class="flex items-center justify-between mb-1">
        <span class="text-sm text-gray-300">Using AI Agent Node</span>
        <span class="text-lg font-bold text-cyan-400">{aiAgentPercentage}%</span>
      </div>
      <div class="relative h-6 bg-gray-800 rounded overflow-hidden">
        <div
          class="absolute inset-y-0 left-0 bg-gradient-to-r from-cyan-600 to-cyan-400 transition-all duration-500"
          style={`width: ${aiAgentPercentage}%;`}
        />
      </div>
      <div class="text-xs text-gray-500 mt-1">
        {formatNumber(aiAgentTemplates!)} templates with AI agents
      </div>
    </div>
  )}
</div>
